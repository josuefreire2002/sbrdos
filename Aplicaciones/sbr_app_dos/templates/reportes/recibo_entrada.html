{% load static %}
{% load humanize %}
{% load numeros_letras %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Recibo de Entrada - Contrato {{ contrato.id }}</title>
    <style>
        /* CONFIGURACIÓN EXACTA DE HOJA */
        @page {
            size: A5 landscape;
            /* Papel medio oficio horizontal */
            margin: 0;
            /* Sin márgenes de impresora */
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            margin: 10mm;
            /* Margen visual interno */
            font-size: 11pt;
            color: #000;
        }

        /* CONTENEDOR PRINCIPAL (Borde redondeado) */
        .container {
            border: 1px solid #000;
            border-radius: 12px;
            padding: 15px 20px;
            height: 125mm;
            /* Altura fija para llenar la hoja */
            position: relative;
        }

        /* --- ENCABEZADO --- */
        .header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
        }

        /* Logo e Info */
        .header-left {
            width: 65%;
            display: flex;
            align-items: center;
        }

        .logo-box {
            width: 100px;
            margin-right: 15px;
        }

        .company-info h1 {
            margin: 0;
            font-size: 16pt;
            font-weight: 900;
            text-transform: uppercase;
        }

        .company-info .slogan {
            font-family: "Times New Roman", serif;
            font-style: italic;
            font-size: 12pt;
            margin: 3px 0;
        }

        .company-info .address {
            font-size: 9pt;
            line-height: 1.2;
        }

        /* Cajas Derecha */
        .header-right {
            width: 32%;
            text-align: right;
        }

        .recibo-title {
            font-weight: 900;
            font-size: 13pt;
            text-transform: uppercase;
            text-align: center;
            line-height: 1.1;
            margin-bottom: 8px;
        }

        /* Caja Fecha */
        .date-box {
            border: 1px solid #000;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 5px;
            display: flex;
            flex-direction: column;
        }

        .date-head {
            background: #000;
            color: #fff;
            font-size: 7pt;
            font-weight: bold;
            display: flex;
            text-align: center;
            padding: 2px 0;
        }

        .date-body {
            display: flex;
            text-align: center;
            font-size: 10pt;
        }

        .d-col {
            flex: 1;
            border-right: 1px solid #000;
            padding: 3px 0;
            background: #fff;
        }

        .d-col:last-child {
            border-right: none;
        }

        /* Caja Valor */
        .valor-wrapper {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-top: 5px;
        }

        .valor-box {
            border: 1px solid #000;
            border-radius: 6px;
            font-size: 13pt;
            font-weight: bold;
            padding: 5px 10px;
            width: 110px;
            text-align: center;
            margin-left: 5px;
        }

        /* --- RENGLONES DE DATOS --- */
        .form-row {
            display: flex;
            align-items: flex-end;
            margin-bottom: 10px;
            font-size: 11pt;
        }

        .label {
            margin-right: 8px;
            white-space: nowrap;
        }

        /* LÍNEA DE ESCRITURA REAL */
        .input-line {
            flex-grow: 1;
            border-bottom: 1px solid #000;
            font-family: "Courier New", monospace;
            font-weight: bold;
            color: #000080;
            padding-left: 10px;
            padding-bottom: 2px;
        }

        /* --- FORMAS DE PAGO --- */
        .pago-section {
            margin-top: 25px;
            border-top: 1px solid #ccc;
            padding-top: 10px;
            display: flex;
            align-items: center;
            font-size: 9pt;
        }

        .check-box {
            width: 14px;
            height: 14px;
            border: 1px solid #000;
            display: inline-block;
            margin: 0 10px 0 5px;
            text-align: center;
            line-height: 12px;
            font-size: 10px;
        }

        .pago-input {
            border-bottom: 1px solid #000;
            min-width: 80px;
            text-align: center;
            color: #000080;
            margin-right: 15px;
        }

        /* --- FOOTER (Firmas) --- */
        .footer {
            position: absolute;
            bottom: 35px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .firma-block {
            width: 32%;
            text-align: center;
        }

        .firma-line {
            border-top: 1px solid #000;
            padding-top: 5px;
            font-weight: bold;
            font-size: 9pt;
        }

        .firma-sub {
            font-weight: normal;
            font-size: 8pt;
            display: block;
        }

        .saldo-block {
            width: 25%;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

        .saldo-box {
            border: 1px solid #000;
            border-radius: 6px;
            padding: 5px;
            width: 90px;
            text-align: center;
            font-weight: bold;
            font-size: 11pt;
            margin-left: 5px;
        }

        .contact-info {
            position: absolute;
            bottom: 8px;
            width: 100%;
            text-align: center;
            font-size: 8pt;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <div class="container">

        <div class="header">
            <div class="header-left">
                <div class="logo-box">
                    <img src="{% static 'img/logo_bellavista.png' %}" style="width: 100%;">
                </div>
                <div class="company-info">
                    <h1>CIUDADELA BELLAVISTA</h1>
                    <div class="slogan">Líderes en Bienes Raíces</div>
                    <div class="address">
                        Dirección: Calle Tovar y Velasco Ibarra<br>
                        (Cashapamba) Pujilí - Ecuador
                    </div>
                </div>
            </div>

            <div class="header-right">
                <div class="recibo-title">COBRO</div>

                <div style="display: flex; align-items: flex-end; justify-content: flex-end;">
                    <span
                        style="font-size: 6pt; margin-right: 3px; transform: rotate(-90deg); margin-bottom: 15px;">FECHA:</span>
                    <div class="date-box" style="width: 140px;">
                        <div class="date-head">
                            <span style="flex:1">DIA</span>
                            <span style="flex:1">MES</span>
                            <span style="flex:1">AÑO</span>
                        </div>
                        <div class="date-body">
                            <div class="d-col">{{ contrato.fecha_contrato|date:"d" }}</div>
                            <div class="d-col">{{ contrato.fecha_contrato|date:"m" }}</div>
                            <div class="d-col">{{ contrato.fecha_contrato|date:"Y" }}</div>
                        </div>
                    </div>
                </div>

                <div class="valor-wrapper">
                    <span style="font-weight: 900; font-size: 12pt;">VALOR $</span>
                    <div class="valor-box">{{ contrato.valor_entrada|floatformat:2|intcomma }}</div>
                </div>
            </div>
        </div>

        <div class="form-row">
            <span class="label">Cliente:</span>
            <div class="input-line">{{ cliente.apellidos }} {{ cliente.nombres }}</div>
        </div>

        <div class="form-row">
            <span class="label">C.I.:</span>
            <div class="input-line" style="flex: 0 0 150px;">{{ cliente.cedula }}</div>

            <span class="label" style="margin-left: 20px;">Telf.:</span>
            <div class="input-line">{{ cliente.celular }}</div>
        </div>

        <div class="form-row">
            <span class="label">Dirección:</span>
            <div class="input-line">{{ cliente.direccion }}</div>
        </div>

        <div class="form-row">
            <span class="label">La suma de:</span>
            <div class="input-line">{{ contrato.valor_entrada|numero_a_letras }}</div>
            <span class="label" style="margin-left: 5px;">Dólares.</span>
        </div>

        <div class="form-row">
            <span class="label">Por concepto de:</span>
            <div class="input-line">ENTRADA - {{ contrato.lotes_display }}
            </div>
        </div>
        <div class="form-row">
            <div class="input-line"></div>
        </div>

        <div class="pago-section">
            En efectivo <div class="check-box">{% if metodo_real_pago == 'EFECTIVO' %}X{% endif %}</div>

            Transferencia <div class="check-box">{% if metodo_real_pago == 'TRANSFERENCIA BANCARIA' %}X{% endif %}</div>

            Cheque Nº <span class="pago-input">
                {% if metodo_real_pago == 'CHEQUE' %}{{ cheque_numero }}{% endif %}
            </span>

            Nº de Cuenta <span class="pago-input">{{ datos_bancarios.cuenta|default:"" }}</span>

            Banco <span class="pago-input" style="flex-grow: 1;">{{ datos_bancarios.banco|default:"" }}</span>
        </div>

        <div class="footer">
            <div class="firma-block">
                <div style="height: 30px;"></div>
                <div class="firma-line">
                    RECIBÍ CONFORME
                    <span class="firma-sub">Nombre: Guillermo Ugsha</span>
                    <span class="firma-sub">C.I.: 050289591-5</span>
                </div>
            </div>

            <div class="firma-block">
                <div style="height: 30px;"></div>
                <div class="firma-line">
                    ENTREGUÉ CONFORME
                    <span class="firma-sub">Nombre: {{ cliente.nombres }}</span>
                    <span class="firma-sub">C.I.: {{ cliente.cedula }}</span>
                </div>
            </div>

            <div class="saldo-block">
                <span>Saldo</span>
                <div class="saldo-box">{{ saldo_pendiente|floatformat:2|intcomma }}</div>
            </div>
        </div>

        <div class="contact-info">
            Celular: 099 820 5377 &nbsp; | &nbsp; E-mail: guilloestud@hotmail.es
        </div>

    </div>

</body>

</html>